<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Get Auto Insurance Quote - Bill Layne Insurance</title>
    
    <!-- Cache Control for HTML (reasonable caching) -->
    <meta http-equiv="Cache-Control" content="max-age=3600, must-revalidate">
    
    <!-- Version Definition -->
    <script>
        // SITE VERSION - Update this when making changes
        window.SITE_VERSION = '2024.12.13.1';
        
        // Check if in development mode
        const isDevelopment = window.location.hostname === 'localhost' || 
                             window.location.hostname === '127.0.0.1' ||
                             window.location.search.includes('dev=true');
        
        // Auto-versioning for development only
        if (isDevelopment) {
            window.SITE_VERSION = Date.now();
            console.log('Development mode: Cache disabled');
        }
    </script>
    
    <!-- Resource Hints for Performance -->
    <!-- DNS Prefetch for external resources -->
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//github.com">
    <link rel="dns-prefetch" href="//cdn.tailwindcss.com">
    <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
    <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
    
    <!-- Preload critical resources -->
    <link rel="preload" href="style.css?v=2024.12.13.1" as="style">
    <link rel="preload" href="app.js?v=2024.12.13.1" as="script">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;800&display=swap" as="style">
    
    <!-- Tailwind CSS for modern styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Preconnect for critical resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;800&display=swap" rel="stylesheet">
    
    <!-- Local Styles with Version -->
    <link rel="stylesheet" href="style.css?v=2024.12.13.1">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    
    <!-- EmailJS SDK -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script type="text/javascript">
        (function() {
            // Initialize EmailJS with your public key
            // To set up EmailJS:
            // 1. Go to https://www.emailjs.com and sign in
            // 2. Add your email service (Gmail, Outlook, etc.)
            // 3. Create an email template with these variables:
            //    {{from_name}}, {{from_email}}, {{phone}}, {{message}}
            // 4. Update the service ID and template ID below
            emailjs.init("Av6wKxL6HR-FIMtgm");
        })();
    </script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        
        .progress-fill {
            transition: width 0.5s ease;
        }
        
        .form-step {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .form-step.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .driver-entry, .vehicle-entry {
            background: #f9f9f9;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            position: relative;
        }
        
        .remove-btn {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Simple Header -->
    <header class="bg-white shadow-sm">
        <div class="container mx-auto px-6 py-4">
            <div class="flex justify-between items-center">
                <a href="index.html" class="text-2xl font-bold text-gray-800">Bill Layne Insurance</a>
                <a href="index.html" class="text-gray-600 hover:text-gray-800">
                    <i class="fas fa-times text-xl"></i>
                </a>
            </div>
        </div>
    </header>

    <!-- Main Form Container -->
    <main class="py-8">
        <div class="container mx-auto px-6 max-w-2xl">
            <div class="bg-white rounded-lg shadow-lg p-8">
                <!-- Progress Bar -->
                <div class="mb-8">
                    <div class="flex justify-between text-sm text-gray-600 mb-2">
                        <span>Step <span id="current-step">1</span> of 6</span>
                        <span><span id="progress-percent">17</span>% Complete</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div id="progress-bar" class="bg-blue-600 h-2 rounded-full progress-fill" style="width: 17%"></div>
                    </div>
                </div>

                <form id="auto-quote-form">
                    <!-- Step 1: Personal Information -->
                    <div class="form-step active" data-step="1">
                        <h2 class="text-2xl font-bold mb-2">Let's get to know you</h2>
                        <p class="text-gray-600 mb-6">We'll start with some basic information to personalize your quote.</p>
                        
                        <div class="space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">First Name*</label>
                                    <input type="text" name="firstname" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Last Name*</label>
                                    <input type="text" name="lastname" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Email Address*</label>
                                <input type="email" name="email" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Phone Number*</label>
                                <input type="tel" name="phone" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Preferred Contact Method</label>
                                <select name="contact_method" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="phone">Phone</option>
                                    <option value="email">Email</option>
                                    <option value="text">Text Message</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Step 2: Drivers -->
                    <div class="form-step" data-step="2">
                        <h2 class="text-2xl font-bold mb-2">Who will be driving?</h2>
                        <p class="text-gray-600 mb-6">Tell us about everyone who will be on the policy.</p>
                        
                        <div id="drivers-container">
                            <div class="driver-entry" data-driver="1">
                                <h3 class="font-semibold mb-3">Primary Driver</h3>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Full Name*</label>
                                        <input type="text" name="driver_1_name" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    </div>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Date of Birth*</label>
                                            <input type="date" name="driver_1_dob" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Gender</label>
                                            <select name="driver_1_gender" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                                <option value="">Select</option>
                                                <option value="male">Male</option>
                                                <option value="female">Female</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Marital Status</label>
                                        <select name="driver_1_marital" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                            <option value="">Select</option>
                                            <option value="single">Single</option>
                                            <option value="married">Married</option>
                                            <option value="divorced">Divorced</option>
                                            <option value="widowed">Widowed</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <button type="button" onclick="addDriver()" class="mt-4 w-full py-2 px-4 border-2 border-dashed border-blue-500 text-blue-500 rounded-md hover:bg-blue-50 transition">
                            <i class="fas fa-plus mr-2"></i>Add Another Driver
                        </button>
                    </div>

                    <!-- Step 3: Current Insurance -->
                    <div class="form-step" data-step="3">
                        <h2 class="text-2xl font-bold mb-2">Current Insurance Status</h2>
                        <p class="text-gray-600 mb-6">This helps us find you the best rates.</p>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Do you currently have auto insurance?</label>
                                <select name="current_insurance" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="yes">Yes</option>
                                    <option value="no">No</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Current Insurance Company (if applicable)</label>
                                <input type="text" name="current_carrier" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Coverage Expiration Date</label>
                                <input type="date" name="coverage_expiration" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                    </div>

                    <!-- Step 4: Vehicles -->
                    <div class="form-step" data-step="4">
                        <h2 class="text-2xl font-bold mb-2">Tell us about your vehicles</h2>
                        <p class="text-gray-600 mb-6">We'll need details for each vehicle you want to insure.</p>
                        
                        <div id="vehicles-container">
                            <div class="vehicle-entry" data-vehicle="1">
                                <h3 class="font-semibold mb-3">Vehicle 1</h3>
                                <div class="space-y-4">
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Year*</label>
                                            <input type="number" name="vehicle_1_year" required min="1900" max="2025" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Make*</label>
                                            <input type="text" name="vehicle_1_make" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Model*</label>
                                            <input type="text" name="vehicle_1_model" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        </div>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">VIN (Optional)</label>
                                        <input type="text" name="vehicle_1_vin" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <button type="button" onclick="addVehicle()" class="mt-4 w-full py-2 px-4 border-2 border-dashed border-blue-500 text-blue-500 rounded-md hover:bg-blue-50 transition">
                            <i class="fas fa-plus mr-2"></i>Add Another Vehicle
                        </button>
                    </div>

                    <!-- Step 5: Coverage Preferences -->
                    <div class="form-step" data-step="5">
                        <h2 class="text-2xl font-bold mb-2">Coverage Preferences</h2>
                        <p class="text-gray-600 mb-6">Select the types of coverage you're interested in.</p>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Liability Limits</label>
                                <select name="liability_limits" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="">Select preferred limits</option>
                                    <option value="state_minimum">State Minimum</option>
                                    <option value="50/100/50">50/100/50</option>
                                    <option value="100/300/100">100/300/100</option>
                                    <option value="250/500/250">250/500/250</option>
                                </select>
                            </div>
                            
                            <div class="space-y-2">
                                <label class="flex items-center">
                                    <input type="checkbox" name="collision" class="mr-2">
                                    <span class="text-sm">Collision Coverage</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" name="comprehensive" class="mr-2">
                                    <span class="text-sm">Comprehensive Coverage</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" name="uninsured_motorist" class="mr-2">
                                    <span class="text-sm">Uninsured/Underinsured Motorist</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" name="medical_payments" class="mr-2">
                                    <span class="text-sm">Medical Payments</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" name="rental_reimbursement" class="mr-2">
                                    <span class="text-sm">Rental Reimbursement</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" name="roadside_assistance" class="mr-2">
                                    <span class="text-sm">Roadside Assistance</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Step 6: Additional Information -->
                    <div class="form-step" data-step="6">
                        <h2 class="text-2xl font-bold mb-2">Almost done!</h2>
                        <p class="text-gray-600 mb-6">Any additional information that might help us get you the best rate?</p>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Have you had any claims in the past 5 years?</label>
                                <select name="previous_claims" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="no">No</option>
                                    <option value="yes">Yes</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Any moving violations in the past 3 years?</label>
                                <select name="violations" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="no">No</option>
                                    <option value="yes">Yes</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Additional Notes (Optional)</label>
                                <textarea name="additional_notes" rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Navigation Buttons -->
                    <div class="flex justify-between mt-8">
                        <button type="button" id="prev-btn" onclick="previousStep()" class="px-6 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition" style="display: none;">
                            <i class="fas fa-arrow-left mr-2"></i>Previous
                        </button>
                        <button type="button" id="next-btn" onclick="nextStep()" class="ml-auto px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition">
                            Next<i class="fas fa-arrow-right ml-2"></i>
                        </button>
                        <button type="submit" id="submit-btn" class="ml-auto px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition" style="display: none;">
                            Submit Quote Request<i class="fas fa-paper-plane ml-2"></i>
                        </button>
                    </div>
                </form>

                <!-- Success Message -->
                <div id="success-message" class="text-center py-12" style="display: none;">
                    <i class="fas fa-check-circle text-green-500 text-6xl mb-4"></i>
                    <h2 class="text-2xl font-bold mb-2">Thank You!</h2>
                    <p class="text-gray-600 mb-6">We've received your quote request and will contact you within 24 hours with your personalized rates.</p>
                    <a href="index.html" class="inline-block px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition">
                        Return to Home
                    </a>
                </div>
            </div>
        </div>
    </main>

    <script>
        let currentStep = 1;
        const totalSteps = 6;
        let driverCount = 1;
        let vehicleCount = 1;

        function updateProgress() {
            const percent = Math.round((currentStep / totalSteps) * 100);
            document.getElementById('current-step').textContent = currentStep;
            document.getElementById('progress-percent').textContent = percent;
            document.getElementById('progress-bar').style.width = percent + '%';
        }

        function showStep(step) {
            document.querySelectorAll('.form-step').forEach(el => {
                el.classList.remove('active');
            });
            document.querySelector(`[data-step="${step}"]`).classList.add('active');
            
            // Update navigation buttons
            document.getElementById('prev-btn').style.display = step === 1 ? 'none' : 'block';
            document.getElementById('next-btn').style.display = step === totalSteps ? 'none' : 'block';
            document.getElementById('submit-btn').style.display = step === totalSteps ? 'block' : 'none';
            
            updateProgress();
        }

        function nextStep() {
            if (validateStep(currentStep)) {
                if (currentStep < totalSteps) {
                    currentStep++;
                    showStep(currentStep);
                }
            }
        }

        function previousStep() {
            if (currentStep > 1) {
                currentStep--;
                showStep(currentStep);
            }
        }

        function validateStep(step) {
            const activeStep = document.querySelector(`[data-step="${step}"]`);
            const requiredFields = activeStep.querySelectorAll('[required]');
            let isValid = true;
            
            requiredFields.forEach(field => {
                if (!field.value.trim()) {
                    field.classList.add('border-red-500');
                    isValid = false;
                } else {
                    field.classList.remove('border-red-500');
                }
            });
            
            if (!isValid) {
                alert('Please fill in all required fields.');
            }
            
            return isValid;
        }

        function addDriver() {
            driverCount++;
            const driverHtml = `
                <div class="driver-entry" data-driver="${driverCount}">
                    <button type="button" onclick="removeEntry(this)" class="remove-btn">×</button>
                    <h3 class="font-semibold mb-3">Additional Driver ${driverCount}</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Full Name*</label>
                            <input type="text" name="driver_${driverCount}_name" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Date of Birth*</label>
                                <input type="date" name="driver_${driverCount}_dob" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Gender</label>
                                <select name="driver_${driverCount}_gender" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="">Select</option>
                                    <option value="male">Male</option>
                                    <option value="female">Female</option>
                                </select>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Marital Status</label>
                            <select name="driver_${driverCount}_marital" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="">Select</option>
                                <option value="single">Single</option>
                                <option value="married">Married</option>
                                <option value="divorced">Divorced</option>
                                <option value="widowed">Widowed</option>
                            </select>
                        </div>
                    </div>
                </div>
            `;
            document.getElementById('drivers-container').insertAdjacentHTML('beforeend', driverHtml);
        }

        function addVehicle() {
            vehicleCount++;
            const vehicleHtml = `
                <div class="vehicle-entry" data-vehicle="${vehicleCount}">
                    <button type="button" onclick="removeEntry(this)" class="remove-btn">×</button>
                    <h3 class="font-semibold mb-3">Vehicle ${vehicleCount}</h3>
                    <div class="space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Year*</label>
                                <input type="number" name="vehicle_${vehicleCount}_year" required min="1900" max="2025" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Make*</label>
                                <input type="text" name="vehicle_${vehicleCount}_make" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Model*</label>
                                <input type="text" name="vehicle_${vehicleCount}_model" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">VIN (Optional)</label>
                            <input type="text" name="vehicle_${vehicleCount}_vin" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>
                </div>
            `;
            document.getElementById('vehicles-container').insertAdjacentHTML('beforeend', vehicleHtml);
        }

        function removeEntry(button) {
            button.closest('.driver-entry, .vehicle-entry').remove();
        }

        // Handle form submission
        document.getElementById('auto-quote-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (!validateStep(currentStep)) {
                return;
            }
            
            const submitBtn = document.getElementById('submit-btn');
            submitBtn.disabled = true;
            submitBtn.innerHTML = 'Submitting... <i class="fas fa-spinner fa-spin ml-2"></i>';
            
            const formData = new FormData(e.target);
            
            // Prepare EmailJS parameters - matching exact template variables
            const templateParams = {
                // These MUST match your EmailJS template variables exactly
                name: `${formData.get('firstname')} ${formData.get('lastname')}`,
                email: formData.get('email'),
                phone: formData.get('phone') || 'Not provided',
                message: generateFullMessage(formData),
                // Also include these in case your template uses them
                from_name: `${formData.get('firstname')} ${formData.get('lastname')}`,
                from_email: formData.get('email')
            };
            
            // Debug log to check values
            console.log('Sending to EmailJS with params:', templateParams);
            console.log('Service ID:', 'service_4flmw3k');
            console.log('Template ID:', 'template_tc5aalp');
            
            // Send via EmailJS
            emailjs.send('service_4flmw3k', 'template_tc5aalp', templateParams)
                .then(function(response) {
                    console.log('EmailJS Success:', response.status, response.text);
                    // Show success message
                    document.getElementById('auto-quote-form').parentElement.style.display = 'none';
                    document.getElementById('success-message').style.display = 'block';
                })
                .catch(function(error) {
                    console.error('EmailJS Error:', error);
                    console.error('Error text:', error.text);
                    console.error('Error status:', error.status);
                    
                    // Show detailed error to help debug
                    if (error.text) {
                        alert(`EmailJS Error: ${error.text}\n\nWe'll open your email client instead.`);
                    }
                    
                    // Try mailto as fallback
                    const subject = encodeURIComponent('Auto Insurance Quote Request');
                    const body = encodeURIComponent(templateParams.message);
                    const mailtoLink = `mailto:Bill@BillLayneInsurance.com?subject=${subject}&body=${body}`;
                    
                    // Show success message anyway since email client will open
                    document.getElementById('auto-quote-form').parentElement.style.display = 'none';
                    document.getElementById('success-message').style.display = 'block';
                    
                    // Open email client after a short delay
                    setTimeout(() => {
                        window.location.href = mailtoLink;
                    }, 1000);
                });
        });

        function generateFullMessage(formData) {
            let message = `New auto insurance quote request:\n\n`;
            message += `CONTACT INFORMATION:\n`;
            message += `Name: ${formData.get('firstname')} ${formData.get('lastname')}\n`;
            message += `Phone: ${formData.get('phone')}\n`;
            message += `Email: ${formData.get('email')}\n`;
            message += `Preferred Contact: ${formData.get('contact_method')}\n\n`;
            
            message += `DRIVERS:\n`;
            for (let i = 1; i <= driverCount; i++) {
                if (formData.get(`driver_${i}_name`)) {
                    message += `Driver ${i}: ${formData.get(`driver_${i}_name`)}\n`;
                    message += `- DOB: ${formData.get(`driver_${i}_dob`) || 'N/A'}\n`;
                    message += `- Gender: ${formData.get(`driver_${i}_gender`) || 'N/A'}\n`;
                    message += `- Marital Status: ${formData.get(`driver_${i}_marital`) || 'N/A'}\n\n`;
                }
            }
            
            message += `VEHICLES:\n`;
            for (let i = 1; i <= vehicleCount; i++) {
                if (formData.get(`vehicle_${i}_year`)) {
                    message += `Vehicle ${i}: ${formData.get(`vehicle_${i}_year`)} ${formData.get(`vehicle_${i}_make`)} ${formData.get(`vehicle_${i}_model`)}\n`;
                    message += `- VIN: ${formData.get(`vehicle_${i}_vin`) || 'N/A'}\n\n`;
                }
            }
            
            message += `COVERAGE PREFERENCES:\n`;
            message += `Liability Limits: ${formData.get('liability_limits') || 'Not specified'}\n`;
            message += `Collision: ${formData.get('collision') ? 'Yes' : 'No'}\n`;
            message += `Comprehensive: ${formData.get('comprehensive') ? 'Yes' : 'No'}\n`;
            message += `Uninsured Motorist: ${formData.get('uninsured_motorist') ? 'Yes' : 'No'}\n`;
            message += `Medical Payments: ${formData.get('medical_payments') ? 'Yes' : 'No'}\n`;
            message += `Rental Reimbursement: ${formData.get('rental_reimbursement') ? 'Yes' : 'No'}\n`;
            message += `Roadside Assistance: ${formData.get('roadside_assistance') ? 'Yes' : 'No'}\n`;
            
            return message;
        }
    </script>
    
    <!-- Main JavaScript with Version -->
    <script src="app.js?v=2024.12.13.1" defer></script>
</body>
</html>